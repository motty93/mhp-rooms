# 更新情報・ロードマップページの実装

**実装日**: 2025年11月7日
**実装時間**: 約2時間
**issue**: #76

## 概要

サービスの更新情報とロードマップを表示するページを実装しました。マークダウンファイルベースでコンテンツを管理し、ビルド時に静的HTMLを生成する仕組みを構築しました。

## 実装内容

### 1. 依存関係の追加

以下のライブラリを追加：
- `github.com/yuin/goldmark` - マークダウンパーサー（CommonMark準拠）
- `github.com/yuin/goldmark-meta` - frontmatter対応
- `github.com/gorilla/feeds` - RSS/Atomフィード生成

### 2. ディレクトリ構造

```
content/
  info/                       # 更新情報用マークダウン
  roadmap/                    # ロードマップ用マークダウン
cmd/
  generate_info/              # 静的生成コマンド
internal/
  info/                       # パーサー・ジェネレーター
    types.go                  # データ構造定義
    parser.go                 # マークダウン→HTML変換
    generator.go              # 静的ファイル生成ロジック
static/
  generated/info/             # 生成された静的ファイル（.gitignore）
templates/
  info/                       # 更新情報テンプレート
  roadmap/                    # ロードマップテンプレート
```

### 3. コア機能

#### マークダウンパーサー
- frontmatterの解析（title, date, slug, category, summary等）
- goldmarkを使用したマークダウン→HTML変換
- ディレクトリ単位での一括パース

#### 静的生成コマンド
- `make generate-info`でマークダウンファイルをスキャン
- articles.json、feed.xml、atom.xmlを生成
- `make build`時に自動実行

#### Webハンドラー
- `/info` - 更新情報一覧
- `/info/{slug}` - 個別記事詳細
- `/roadmap` - ロードマップ一覧
- `/info-feed.xml` - RSSフィード

### 4. テンプレート

既存のFAQ/ガイドページのデザインパターンを踏襲：
- Tailwind CSSによるスタイリング
- Alpine.jsでタブ切り替え
- レスポンシブ対応

### 5. フッター更新

フッターの「リンク」セクションに以下を追加：
- 更新情報
- ロードマップ

## 技術的な工夫

### frontmatter形式
```yaml
title: "タイトル"
slug: "url-slug"
date: 2025-11-07T10:00:00+09:00
category: "release|maintenance|roadmap"
summary: "要約文"
tags: ["tag1", "tag2"]
draft: false
status: "planned"  # ロードマップ用
```

### カテゴリー分け
- `release` - リリース情報
- `maintenance` - メンテナンス告知
- `roadmap` - ロードマップ項目

### RSS/Atomフィード
- 最新20件の更新情報を配信
- ロードマップは含めず、releaseとmaintenanceのみ

### ビルド時生成
- Makefileに`generate-info`タスクを統合
- `build`タスクの依存関係に追加し、ビルド時に自動生成
- 生成ファイルは`.gitignore`に追加

## サンプルコンテンツ

以下のサンプルを作成：
- リリース情報: v1.0.0
- メンテナンス告知: 計画メンテナンス
- ロードマップ: 通知機能、DM機能、ユーザー検索機能

## 動作確認

- ✅ 静的ファイル生成が正常に動作（7件の記事を処理）
- ✅ JSONファイル生成
- ✅ RSS/Atomフィード生成
- ✅ ビルドが成功
- ✅ サーバーが正常起動

## ハマったポイント

### 1. モジュールパスの誤り
最初`github.com/motty93/mhp-rooms`を使用していたが、go.modでは`mhp-rooms`が正しいパス。
全てのインポートパスを修正。

### 2. TemplateData構造体
`Data`フィールドではなく`PageData`フィールドを使用する必要があった。
既存のview.Data構造体の定義を確認して修正。

### 3. テンプレート内のデータアクセス
`.Articles`ではなく`.PageData.Articles`でアクセスする必要があった。
全テンプレートを修正。

## 今後の改善点

- [ ] カテゴリータブの動的フィルタリング（現在はページリロード）
- [ ] ページネーション（記事数が増えた場合）
- [ ] 検索機能
- [ ] ロードマップのステータス別ソート
- [ ] OGP画像の自動生成

## 参考にした実装

- 既存のFAQページ（`templates/pages/faq.tmpl`）
- 既存のPageHandler（`internal/handlers/page.go`）
- ルーム一覧のページネーション（将来的に導入予定）

## 備考

- マークダウンファイルは手動で作成・編集
- 更新後は`make generate-info`または`make build`を実行
- 本番環境ではビルド時に静的ファイルが生成されるため、デプロイ時の手動実行は不要
