# 部屋のパスワード・人数制限機能の実装

## 実装内容

ルームに対するパスワード認証機能と人数制限機能を実装した。

## 実装した機能

### 1. パスワード機能

**パスワードユーティリティ (`internal/utils/password.go`)**
```go
func HashPassword(password string) (string, error)
func CheckPassword(password, hash string) bool
```

**Roomモデルのメソッド追加**
```go
func (r *Room) SetPassword(password string) error
func (r *Room) CheckPassword(password string) bool
func (r *Room) HasPassword() bool
```

### 2. 人数制限機能

**Roomモデルのメソッド追加**
```go
func (r *Room) IsFull() bool
func (r *Room) CanJoin() bool
```

### 3. Repository層の機能

**ルーム参加機能 (`JoinRoom`)**
- パスワード認証
- 人数制限チェック
- 重複参加防止
- トランザクション処理

**ルーム退室機能 (`LeaveRoom`)**
- 参加者数の自動調整
- ステータス更新

### 4. Handler層のAPI

**POST `/rooms`** - ルーム作成
- パスワード設定対応
- 最大人数設定

**POST `/rooms/{id}/join`** - ルーム参加
- パスワード認証
- 人数制限チェック

**POST `/rooms/{id}/leave`** - ルーム退室
- 参加者数調整

## APIの使用例

### パスワード付きルーム作成
```json
POST /rooms
{
  "name": "ハンター募集",
  "game_version_id": "uuid",
  "max_players": 4,
  "password": "secret123"
}
```

### ルーム参加
```json
POST /rooms/{id}/join
{
  "password": "secret123"
}
```

## セキュリティ対策

- bcryptによるパスワードハッシュ化
- パスワードハッシュは外部に公開されない
- トランザクションによるデータ整合性保証

## 制約・チェック

- 最大4人までの人数制限
- アクティブなルームのみ参加可能
- 待機中のルームのみ参加可能
- 重複参加の防止
- パスワード認証の必須化（パスワード設定時）